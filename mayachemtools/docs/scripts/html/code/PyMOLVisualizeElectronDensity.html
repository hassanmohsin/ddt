<html>
<head>
<title>MayaChemTools:Code:PyMOLVisualizeElectronDensity.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: PyMOLVisualizeElectronDensity.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2018 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using PyMOL, a</span>
    9 <span class="c1"># molecular visualization system on an open source foundation originally</span>
   10 <span class="c1"># developed by Warren DeLano.</span>
   11 <span class="c1">#</span>
   12 <span class="c1"># This file is part of MayaChemTools.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   15 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   16 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   17 <span class="c1"># later version.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   20 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   21 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   22 <span class="c1"># details.</span>
   23 <span class="c1">#</span>
   24 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   25 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   26 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   27 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   28 <span class="c1">#</span>
   29 
   30 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   31 
   32 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   33 <span class="kn">import</span> <span class="nn">os</span>
   34 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   35 <span class="kn">import</span> <span class="nn">time</span>
   36 <span class="kn">import</span> <span class="nn">re</span>
   37 
   38 <span class="c1"># PyMOL imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">import</span> <span class="nn">pymol</span>
   41     <span class="c1"># Finish launching PyMOL in  a command line mode for batch processing (-c)</span>
   42     <span class="c1"># along with the following options:  disable loading of pymolrc and plugins (-k);</span>
   43     <span class="c1"># suppress start up messages (-q)</span>
   44     <span class="n">pymol</span><span class="o">.</span><span class="n">finish_launching</span><span class="p">([</span><span class="s1">&#39;pymol&#39;</span><span class="p">,</span> <span class="s1">&#39;-ckq&#39;</span><span class="p">])</span>
   45 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import PyMOL module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your PyMOL environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   48     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   49 
   50 <span class="c1"># MayaChemTools imports...</span>
   51 <span class="k">try</span><span class="p">:</span>
   52     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   53     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   54     <span class="kn">import</span> <span class="nn">PyMOLUtil</span>
   55 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   58     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   59 
   60 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   61 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   62 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   63 
   64 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   65     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   66     
   67     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (PyMOL v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">) Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">get_version</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   68     
   69     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   70     
   71     <span class="c1"># Retrieve command line arguments and options...</span>
   72     <span class="n">RetrieveOptions</span><span class="p">()</span>
   73     
   74     <span class="c1"># Process and validate command line arguments and options...</span>
   75     <span class="n">ProcessOptions</span><span class="p">()</span>
   76 
   77     <span class="c1"># Perform actions required by the script...</span>
   78     <span class="n">GenerateElectronDensityVisualization</span><span class="p">()</span>
   79     
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   81     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   82 
   83 <span class="k">def</span> <span class="nf">GenerateElectronDensityVisualization</span><span class="p">():</span>
   84     <span class="sd">&quot;&quot;&quot;Generate electron density visualization.&quot;&quot;&quot;</span>
   85 
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
   87     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
   88     <span class="k">if</span> <span class="n">OutFH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
   89         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to open output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   90     
   91     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   92 
   93     <span class="c1"># Setup PyMOL object names...</span>
   94     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="n">SetupPyMOLObjectNames</span><span class="p">()</span>
   95 
   96     <span class="c1"># Setup header and complex view...</span>
   97     <span class="n">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">)</span>
   98     <span class="n">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   99     <span class="n">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  100 
  101     <span class="c1"># Setup chain views...</span>
  102     <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">True</span>
  103     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  104         <span class="n">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  105         
  106         <span class="c1"># Setup ligand views...</span>
  107         <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">True</span>
  108         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  109             <span class="n">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  110             
  111             <span class="c1"># Set up ligand level group...</span>
  112             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  113             <span class="k">if</span> <span class="n">FirstLigand</span><span class="p">:</span>
  114                 <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">False</span>
  115                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  116             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  117             
  118         <span class="c1"># Setup Chain level group...</span>
  119         <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  120         <span class="k">if</span> <span class="n">FirstChain</span><span class="p">:</span>
  121             <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">False</span>
  122             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  123         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  124         
  125     <span class="c1"># Set up complex level group...</span>
  126     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  127 
  128     <span class="c1"># Delete empty PyMOL objects...</span>
  129     <span class="n">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  130         
  131     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;visible&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  132     
  133     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  134 
  135     <span class="c1"># Generate PSE file as needed...</span>
  136     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]:</span>
  137         <span class="n">GeneratePyMOLSessionFile</span><span class="p">()</span>
  138 
  139 <span class="k">def</span> <span class="nf">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">):</span>
  140     <span class="sd">&quot;&quot;&quot;Write out PML setting up complex view&quot;&quot;&quot;</span>
  141 
  142     <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  143     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">HeaderInfo</span><span class="p">)</span>
  144 
  145 <span class="k">def</span> <span class="nf">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  146     <span class="sd">&quot;&quot;&quot;Write out PyMOL global parameters. &quot;&quot;&quot;</span>
  147 
  148     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  149     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;mesh_width&quot;, </span><span class="si">%.2f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshWidth&quot;</span><span class="p">]))</span>
  150     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;transparency&quot;, </span><span class="si">%.2f</span><span class="s2">, &quot;&quot;, 0)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]))</span>
  151     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_font_id&quot;, </span><span class="si">%s</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]))</span>
  152     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  153     
  154     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up PyMOL gobal parameters...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  155     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  156     
  157 <span class="k">def</span> <span class="nf">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  158     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polymer complex along with electron density.&quot;&quot;&quot;</span>
  159 
  160     <span class="c1"># Setup complex...</span>
  161     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
  162     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for complex...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  163     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  164 
  165     <span class="c1"># Setup electron density maps and meshes...</span>
  166     <span class="n">WriteComplexCompositeElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  167     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  168         <span class="n">WriteComplexDifferenceElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  169 
  170     <span class="c1"># Setup complex group...</span>
  171     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  172 
  173 <span class="k">def</span> <span class="nf">WriteComplexCompositeElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  174     <span class="sd">&quot;&quot;&quot;Write out PML for viewing composite maps.&quot;&quot;&quot;</span>
  175 
  176     <span class="c1"># Load composite map (2Fo - Fc) and setup mesh views...</span>
  177     <span class="n">MapFileName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapFiles&quot;</span><span class="p">][</span><span class="s2">&quot;CompositeMap&quot;</span><span class="p">]</span>
  178     <span class="n">Info</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  179 <span class="s2">&quot;&quot;</span>
  180 <span class="s2">&quot;Loading composite map (2Fo - Fc) </span><span class="si">%s</span><span class="s2"> and setting up mesh view for complex...&quot;</span>
  181 <span class="s2">&quot;&quot; &quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">MapFileName</span>
  182     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Info</span><span class="p">)</span>
  183 
  184     <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span>
  185     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  186     
  187     <span class="n">ContourLevel</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">]</span>
  188     <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">]</span>
  189     
  190     <span class="n">MeshName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMesh&quot;</span><span class="p">]</span>
  191     <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDSurface&quot;</span><span class="p">]</span>
  192     
  193     <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMap</span><span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  194     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  195 
  196     <span class="n">EnableSurface</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="bp">True</span>
  197     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  198         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  199         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  200 
  201     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  202         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  203         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  204 
  205     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  206     
  207 <span class="k">def</span> <span class="nf">WriteComplexDifferenceElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  208     <span class="sd">&quot;&quot;&quot;Write out PML for viewing difference maps.&quot;&quot;&quot;</span>
  209 
  210     <span class="c1"># Load difference map (Fo - Fc ) and setup mesh views...</span>
  211     <span class="n">MapFileName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapFiles&quot;</span><span class="p">][</span><span class="s2">&quot;DifferenceMap&quot;</span><span class="p">]</span>
  212     <span class="n">Info</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  213 <span class="s2">&quot;&quot;</span>
  214 <span class="s2">&quot;Loading difference map (Fo - Fc ) map </span><span class="si">%s</span><span class="s2"> and setting up mesh views...&quot;</span>
  215 <span class="s2">&quot;&quot; &quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">MapFileName</span>
  216     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Info</span><span class="p">)</span>
  217 
  218     <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span>
  219     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  220 
  221     <span class="n">ContourLevel1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">]</span>
  222     <span class="n">ContourLevel2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">]</span>
  223     <span class="n">Color1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">]</span>
  224     <span class="n">Color2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">]</span>
  225     
  226     <span class="n">Mesh1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh1&quot;</span><span class="p">]</span>
  227     <span class="n">Surface1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface1&quot;</span><span class="p">]</span>
  228     <span class="n">Mesh2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh2&quot;</span><span class="p">]</span>
  229     <span class="n">Surface2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface2&quot;</span><span class="p">]</span>
  230     
  231     <span class="n">EnableSurface</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="bp">True</span>
  232     
  233     <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMap</span><span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  234     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  235     
  236     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  237         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  238         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  239         
  240     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  241         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  242         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  243     
  244     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  245         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  246         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  247     
  248     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  249         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  250         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  251     
  252     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  253 
  254 <span class="k">def</span> <span class="nf">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  255     <span class="sd">&quot;&quot;&quot;Write out PML for viewing chain.&quot;&quot;&quot;</span>
  256     
  257     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span>
  258     
  259     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  260     
  261     <span class="c1"># Setup chain complex group view...</span>
  262     <span class="n">WriteChainComplexAndMeshViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  263 
  264     <span class="c1"># Setup chain view...</span>
  265     <span class="n">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  266     
  267     <span class="c1"># Setup chain solvent view...</span>
  268     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSolventView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  269     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  270 
  271     <span class="c1"># Setup chain inorganic view...</span>
  272     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  273     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  274 
  275 <span class="k">def</span> <span class="nf">WriteChainComplexAndMeshViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  276     <span class="sd">&quot;&quot;&quot;Write chain complex and mesh views. &quot;&quot;&quot;</span>
  277     
  278     <span class="c1"># Setup chain complex...</span>
  279     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  280     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  281     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  282 
  283     <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  284     <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  285     
  286     <span class="n">EnableSurface</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">MeshChainComplex</span> <span class="k">else</span> <span class="bp">True</span>
  287     
  288     <span class="k">if</span> <span class="n">MeshChainComplex</span> <span class="ow">or</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  289         <span class="c1"># Set up composite mesh and group...</span>
  290         <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span>
  291         <span class="n">ContourLevel</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">]</span>
  292         <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">]</span>
  293         
  294         <span class="n">MeshName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDMesh&quot;</span><span class="p">]</span>
  295         <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDSurface&quot;</span><span class="p">]</span>
  296         
  297         <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  298             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  299             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  300         
  301         <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  302             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  303             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  304         
  305         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  306         
  307         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  308             <span class="c1"># Set up difference meshes and group...</span>
  309             <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span>
  310             
  311             <span class="n">ContourLevel1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">]</span>
  312             <span class="n">ContourLevel2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">]</span>
  313             <span class="n">Color1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">]</span>
  314             <span class="n">Color2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">]</span>
  315         
  316             <span class="n">Mesh1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh1&quot;</span><span class="p">]</span>
  317             <span class="n">Surface1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface1&quot;</span><span class="p">]</span>
  318             <span class="n">Mesh2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh2&quot;</span><span class="p">]</span>
  319             <span class="n">Surface2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface2&quot;</span><span class="p">]</span>
  320         
  321             <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  322                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  323                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  324             
  325             <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  326                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  327                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  328             
  329             <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  330                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  331                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  332             
  333             <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  334                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  335                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  336         
  337             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  338     
  339     <span class="c1"># Setup chain complex group...</span>
  340     <span class="n">EnableChainComplexGroup</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;EnableChainComplexGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  341     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">],</span> <span class="n">EnableChainComplexGroup</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  342     
  343 <span class="k">def</span> <span class="nf">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  344     <span class="sd">&quot;&quot;&quot;Write individual chain views. &quot;&quot;&quot;</span>
  345 
  346     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  347     
  348     <span class="c1"># Setup chain view...</span>
  349     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  350     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  351     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  352 
  353     <span class="c1"># Setup chain putty by B-factor view...</span>
  354     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorChainCartoonPutty&quot;</span><span class="p">]:</span>
  355         <span class="n">BFactorPuttyName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneBFactorPutty&quot;</span><span class="p">]</span>
  356         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForBFactorPuttyView</span><span class="p">(</span><span class="n">BFactorPuttyName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  357         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  358         
  359     <span class="c1"># Setup chain group...</span>
  360     <span class="n">EnableChainAloneGroup</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;EnableChainAloneGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  361     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">],</span> <span class="n">EnableChainAloneGroup</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  362     
  363 <span class="k">def</span> <span class="nf">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  364     <span class="sd">&quot;&quot;&quot;Write out PML for viewing ligand in a chain.&quot;&quot;&quot;</span>
  365     
  366     <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  367         <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  368         <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  369         
  370         <span class="c1"># Setup main object...</span>
  371         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  372         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  373         
  374         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  375             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  376             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  377             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  378         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  379             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for pocket around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  380             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
  381             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  382             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">GroupTypeObjectName</span><span class="p">))</span>
  383         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  384             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for solvent in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  385             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketSolventView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  386             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  387         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  388             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for inorganic in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  389             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketInorganicView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  390             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  391         
  392         <span class="c1"># Set up composite mesh and group...</span>
  393         <span class="n">CompositeMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  394         <span class="n">CompositeMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  395         <span class="n">CompositeMeshID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  396         <span class="n">CompositeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  397 
  398         <span class="n">CompositeMapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span>
  399         <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshID</span><span class="p">]</span>
  400         <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeSurfaceID</span><span class="p">]</span>
  401         <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupID</span><span class="p">]</span>
  402         <span class="n">CompositeMeshGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span>
  403         
  404         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeMeshName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  405         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  406         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeSurfaceName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  407         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  408         
  409         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">CompositeMeshGroupName</span><span class="p">,</span> <span class="n">CompositeMeshGroupMembers</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  410         
  411         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  412             <span class="c1"># Set up difference meshes and group...</span>
  413             <span class="n">DiffMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  414             <span class="n">DiffMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  415             <span class="n">DiffMesh1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  416             <span class="n">DiffSurface1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  417             <span class="n">DiffMesh2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  418             <span class="n">DiffSurface2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  419         
  420             <span class="n">DiffMapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span>
  421             <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh1ID</span><span class="p">]</span>
  422             <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface1ID</span><span class="p">]</span>
  423             <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh2ID</span><span class="p">]</span>
  424             <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface2ID</span><span class="p">]</span>
  425             <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupID</span><span class="p">]</span>
  426             <span class="n">DiffMeshGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span>
  427             
  428             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffMesh1Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  429             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  430             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffSurface1Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  431             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  432             
  433             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffMesh2Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  434             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  435             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffSurface2Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  436             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  437         
  438             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">DiffMeshGroupName</span><span class="p">,</span> <span class="n">DiffMeshGroupMembers</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  439         
  440         <span class="c1"># Set up polar contacts...</span>
  441         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|PocketSolvent|PocketInorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  442             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  443             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span>
  444             
  445             <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span>
  446             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  447                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span>
  448             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  449                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span>
  450             
  451             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">PolarContactsColor</span><span class="p">)</span>
  452             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  453             
  454             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">PolarContactsName</span><span class="p">))</span>
  455             
  456         <span class="c1"># Set up hydrophobic surface...</span>
  457         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]:</span>
  458             <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  459             <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  460             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="s2">&quot;RedToWhite&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  461             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  462             
  463             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicSurfaceName</span><span class="p">))</span>
  464         
  465         <span class="c1"># Setup group....</span>
  466         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  467         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  468         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  469         <span class="n">GroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span>
  470 
  471         <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span>
  472         <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span>
  473         <span class="k">if</span>  <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Ligand|Pocket)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  474             <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span>
  475             <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span>
  476         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  477 
  478 <span class="k">def</span> <span class="nf">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
  479     <span class="sd">&quot;&quot;&quot;Generate and write PML for group. &quot;&quot;&quot;</span>
  480     
  481     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  482     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up group </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
  483     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  484 
  485 <span class="k">def</span> <span class="nf">SetupPMLForElectronDensityMap</span><span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  486     <span class="sd">&quot;&quot;&quot;Setup PML for loading and viewing electron density map. &quot;&quot;&quot;</span>
  487 
  488     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  489     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  490     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
  491     
  492     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  493     
  494     <span class="k">return</span> <span class="n">PML</span>
  495     
  496 <span class="k">def</span> <span class="nf">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  497     <span class="sd">&quot;&quot;&quot;Setup PML for electron density mesh. &quot;&quot;&quot;</span>
  498 
  499     <span class="n">Carve</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshCarveRadius&quot;</span><span class="p">]</span>
  500     
  501     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  502     <span class="k">if</span> <span class="n">Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  503         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isomesh(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MeshName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">))</span>
  504     <span class="k">else</span><span class="p">:</span>
  505         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isomesh(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;, carve = </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MeshName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Carve</span><span class="p">))</span>
  506     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">))</span>
  507     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MeshName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
  508     
  509     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  510     
  511     <span class="k">return</span> <span class="n">PML</span>
  512 
  513 <span class="k">def</span> <span class="nf">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  514     <span class="sd">&quot;&quot;&quot;Setup PML for electron density surface. &quot;&quot;&quot;</span>
  515 
  516     <span class="n">Carve</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshCarveRadius&quot;</span><span class="p">]</span>
  517     
  518     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  519     <span class="k">if</span> <span class="n">Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  520         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isosurface(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">))</span>
  521     <span class="k">else</span><span class="p">:</span>
  522         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isosurface(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;, carve = </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Carve</span><span class="p">))</span>
  523     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">))</span>
  524     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
  525     
  526     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  527     
  528     <span class="k">return</span> <span class="n">PML</span>
  529 
  530 <span class="k">def</span> <span class="nf">GeneratePyMOLSessionFile</span><span class="p">():</span>
  531     <span class="sd">&quot;&quot;&quot;Generate PME file from PML file. &quot;&quot;&quot;</span>
  532 
  533     <span class="n">PSEOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span>
  534     <span class="n">PMLOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
  535     
  536     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  537     
  538     <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">,</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  539     
  540     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PSEOutfile</span><span class="p">):</span>
  541         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Failed to generate PSE file, </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PSEOutfile</span><span class="p">))</span>
  542     
  543     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]:</span>
  544         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Deleting file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PMLOutfile</span><span class="p">)</span>
  545         <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">)</span>
  546 
  547 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  548     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL objects. &quot;&quot;&quot;</span>
  549     
  550     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  551         <span class="k">return</span>
  552         
  553     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  554         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Checking and deleting empty objects for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  555         <span class="c1"># Delete any chain level objects...</span>
  556         <span class="n">WritePMLToCheckAndDeleteEmptyObject</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">])</span>
  557         <span class="n">WritePMLToCheckAndDeleteEmptyObject</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">])</span>
  558         
  559         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  560             <span class="c1"># Delete ligand level objects...</span>
  561             <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  562                 <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  563                 <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  564 
  565                 <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  566                 <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  567                 
  568                 <span class="n">WritePMLToCheckAndDeleteEmptyObject</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  569 
  570 <span class="k">def</span> <span class="nf">WritePMLToCheckAndDeleteEmptyObject</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  571     <span class="sd">&quot;&quot;&quot;Write PML to check and delete empty PyMOL objects. &quot;&quot;&quot;</span>
  572     
  573     <span class="k">if</span> <span class="n">ParentObjectName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  574         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObject(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span>
  575     <span class="k">else</span><span class="p">:</span>
  576         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObject(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span><span class="p">)</span>
  577     
  578     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  579 
  580 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNames</span><span class="p">():</span>
  581     <span class="sd">&quot;&quot;&quot;Setup hierarchy of PyMOL groups and objects for ligand centric views of</span>
  582 <span class="sd">    electron density for chains and ligands present in input file.</span>
  583 <span class="sd">    &quot;&quot;&quot;</span>
  584 
  585     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
  586     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  587     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  588 
  589     <span class="c1"># Setup groups and objects for complex...</span>
  590     <span class="n">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">)</span>
  591     
  592     <span class="c1"># Setup groups and objects for chain...</span>
  593     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  594         <span class="n">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  595         
  596         <span class="c1"># Setup groups and objects for ligand...</span>
  597         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  598             <span class="n">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  599 
  600     <span class="k">return</span> <span class="n">PyMOLObjectNames</span>
  601 
  602 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">):</span>
  603     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for complex. &quot;&quot;&quot;</span>
  604     
  605     <span class="n">PDBFileRoot</span>  <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileRoot&quot;</span><span class="p">]</span>
  606     
  607     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PDBFileRoot</span>
  608     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBGroupName</span>
  609     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  610 
  611     <span class="n">ComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  612     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexGroupName</span>
  613     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  614     
  615     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  616 
  617     <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.2Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  618     <span class="n">CompositeMapName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Map&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  619     <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  620     <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  621     
  622     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshGroupName</span>
  623     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMapName</span>
  624     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshName</span>
  625     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSurfaceName</span>
  626 
  627     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  628     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">)</span>
  629     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  630         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshName</span><span class="p">)</span>
  631     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  632         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeSurfaceName</span><span class="p">)</span>
  633     
  634     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  635         <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Fo-Fc&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  636         <span class="n">DiffMapName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Map&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  637         <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  638         <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  639         <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  640         <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  641         
  642         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMeshGroupName</span>
  643         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMapName</span>
  644         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh1Name</span>
  645         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface1Name</span>
  646         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh2Name</span>
  647         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface2Name</span>
  648         
  649         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  650         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">)</span>
  651         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  652             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh1Name</span><span class="p">)</span>
  653         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  654             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface1Name</span><span class="p">)</span>
  655         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  656             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh2Name</span><span class="p">)</span>
  657         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  658             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface2Name</span><span class="p">)</span>
  659     
  660     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  661     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">])</span>
  662     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroup&quot;</span><span class="p">])</span>
  663     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  664         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroup&quot;</span><span class="p">])</span>
  665     
  666 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  667     <span class="sd">&quot;&quot;&quot;Setup groups and objects for chain.&quot;&quot;&quot;</span>
  668     
  669     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  670     
  671     <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  672     <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  673     
  674     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  675     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  676     
  677     <span class="c1"># Set up chain group and chain objects...</span>
  678     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBGroupName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  679     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
  680     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  681     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  682     
  683     <span class="c1"># Setup chain complex group and objects...</span>
  684     <span class="n">ChainComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  685     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainComplexGroupName</span>
  686     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  687     
  688     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  689     
  690     <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.2Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  691     <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  692     <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  693     
  694     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshGroupName</span>
  695     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDMesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshName</span>
  696     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSurfaceName</span>
  697     
  698     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  699     <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  700         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshName</span><span class="p">)</span>
  701     <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  702         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeSurfaceName</span><span class="p">)</span>
  703     
  704     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  705         <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  706         <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  707         <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  708         <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  709         <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  710         
  711         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMeshGroupName</span>
  712         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh1Name</span>
  713         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface1Name</span>
  714         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh2Name</span>
  715         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface2Name</span>
  716         
  717         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  718         <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  719             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh1Name</span><span class="p">)</span>
  720         <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  721             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface1Name</span><span class="p">)</span>
  722         <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  723             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh2Name</span><span class="p">)</span>
  724         <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  725             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface2Name</span><span class="p">)</span>
  726         
  727     <span class="n">NameIDs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  728     <span class="k">if</span> <span class="n">MeshChainComplex</span> <span class="ow">or</span> <span class="n">SurfaceChainComplex</span> <span class="p">:</span>
  729         <span class="n">NameIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ChainComplexCompositeEDGroup&quot;</span><span class="p">)</span>
  730         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  731             <span class="n">NameIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ChainComplexDiffEDGroup&quot;</span><span class="p">)</span>
  732         
  733     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  734     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="n">NameIDs</span><span class="p">:</span>
  735         <span class="n">Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span>
  736         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  737 
  738     <span class="c1"># Setup up a group for individual chains...</span>
  739     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  740     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainAloneGroupName</span>
  741     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  742         
  743     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  744         
  745     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  746     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  747     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  748         
  749     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorChainCartoonPutty&quot;</span><span class="p">]:</span>
  750         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.BFactor&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  751         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneBFactorPutty&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  752         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  753     
  754     <span class="c1"># Setup solvent and inorganic objects for chain...</span>
  755     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Inorganic&quot;</span><span class="p">]:</span>
  756         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">NameID</span><span class="p">)</span>
  757         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  758         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  759 
  760 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  761     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for ligand.&quot;&quot;&quot;</span>
  762 
  763     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  764     
  765     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
  766     
  767     <span class="c1"># Setup a chain level ligand group...</span>
  768     <span class="n">ChainLigandGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  769     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainLigandGroupName</span>
  770     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
  771     
  772     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  773 
  774     <span class="c1"># Set up groups and objects for a specific ligand group...</span>
  775     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Inorganic&quot;</span><span class="p">]:</span>
  776         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  777         <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  778                 
  779         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  780         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  781         
  782         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
  783         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  784         
  785         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  786         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  787         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span>
  788         
  789         <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.2Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  790         <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  791         <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  792                 
  793         <span class="n">CompositeMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  794         <span class="n">CompositeMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  795         <span class="n">CompositeMeshID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  796         <span class="n">CompositeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  797         
  798         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshGroupName</span>
  799         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshName</span>
  800         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSurfaceName</span>
  801         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  802         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshName</span><span class="p">)</span>
  803         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeSurfaceName</span><span class="p">)</span>
  804                 
  805         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  806             <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Fo-Fc&quot;</span> <span class="o">%</span> <span class="n">GroupName</span>
  807             <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  808             <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  809             <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  810             <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  811                     
  812             <span class="n">DiffMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  813             <span class="n">DiffMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  814             <span class="n">DiffMesh1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  815             <span class="n">DiffSurface1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  816             <span class="n">DiffMesh2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  817             <span class="n">DiffSurface2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  818                     
  819             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMeshGroupName</span>
  820             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh1ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh1Name</span>
  821             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface1ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface1Name</span>
  822             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh2ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh2Name</span>
  823             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface2ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface2Name</span>
  824             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  825             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">DiffMesh1Name</span><span class="p">,</span> <span class="n">DiffSurface1Name</span><span class="p">,</span> <span class="n">DiffMesh2Name</span><span class="p">,</span> <span class="n">DiffSurface2Name</span><span class="p">])</span>
  826                 
  827         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  828         <span class="n">NameIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">GroupTypeObjectID</span><span class="p">,</span> <span class="n">CompositeMeshGroupID</span><span class="p">]</span>
  829         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]:</span>
  830             <span class="n">NameIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMeshGroupID</span><span class="p">)</span>
  831         
  832         <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="n">NameIDs</span><span class="p">:</span>
  833             <span class="n">Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span>
  834             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  835         
  836         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  837             <span class="c1"># No other object needed for Ligand group...</span>
  838             <span class="k">continue</span>
  839         
  840         <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Polar_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  841         <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  842         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolarContactsName</span>
  843         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">)</span>
  844                 
  845         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  846             <span class="c1"># No other object needed for any other group besides Pocket...</span>
  847             <span class="k">continue</span>
  848         
  849         <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]:</span>
  850             <span class="k">continue</span>
  851         
  852         <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  853         <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  854         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicSurfaceName</span>
  855         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">)</span>
  856 
  857 <span class="k">def</span> <span class="nf">ProcessEDMapSuffixes</span><span class="p">():</span>
  858     <span class="sd">&quot;&quot;&quot;Process suffixes for ED map files&quot;&quot;&quot;</span>
  859     
  860     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;CompositeMap&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;DifferenceMap&quot;</span> <span class="p">:</span> <span class="s2">&quot;_diff&quot;</span><span class="p">}</span>
  861     
  862     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  863         <span class="n">SetupEDMapFileNames</span><span class="p">()</span>
  864         <span class="k">return</span>
  865     
  866     <span class="n">EDMapSuffixes</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixes&quot;</span><span class="p">])</span>
  867     <span class="k">if</span> <span class="ow">not</span> <span class="n">EDMapSuffixes</span><span class="p">:</span>
  868         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span><span class="p">)</span>
  869     
  870     <span class="n">EDMapSuffixesWords</span> <span class="o">=</span> <span class="n">EDMapSuffixes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
  871     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EDMapSuffixesWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
  872         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited ED map types names and suffixes, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">EDMapSuffixesWords</span><span class="p">)))</span>
  873 
  874     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">EDMapSuffixesWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
  875         <span class="n">EDMapType</span> <span class="o">=</span> <span class="n">EDMapSuffixesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  876         <span class="n">EDMapSuffix</span> <span class="o">=</span> <span class="n">EDMapSuffixesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
  877         
  878         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompositeMap$&quot;</span><span class="p">,</span> <span class="n">EDMapType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  879             <span class="n">EDMapType</span> <span class="o">=</span> <span class="s2">&quot;CompositeMap&quot;</span>
  880         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^DifferenceMap$&quot;</span><span class="p">,</span> <span class="n">EDMapType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  881             <span class="n">EDMapType</span> <span class="o">=</span> <span class="s2">&quot;DifferenceMap&quot;</span>
  882         <span class="k">else</span><span class="p">:</span>
  883             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The ED map type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2"> option is not a valid ED map type. Supported ED map types: CompositeMap, DifferenceMap&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">EDMapType</span><span class="p">))</span>
  884             
  885         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">EDMapSuffix</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  886             <span class="n">EDMapSuffix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  887         
  888         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">][</span><span class="n">EDMapType</span><span class="p">]</span> <span class="o">=</span> <span class="n">EDMapSuffix</span>
  889     
  890     <span class="n">SetupEDMapFileNames</span><span class="p">()</span>
  891 
  892 <span class="k">def</span> <span class="nf">SetupEDMapFileNames</span><span class="p">():</span>
  893     <span class="sd">&quot;&quot;&quot;Set up ED map file names. &quot;&quot;&quot;</span>
  894     
  895     <span class="n">PDBFileRoot</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileRoot&quot;</span><span class="p">]</span>
  896     
  897     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  898     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  899     
  900     <span class="k">for</span> <span class="n">EDMapType</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">]):</span>
  901         <span class="n">EDMapSuffix</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">][</span><span class="n">EDMapType</span><span class="p">]</span>
  902         <span class="n">EDMapFile</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">.ccp4&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBFileRoot</span><span class="p">,</span> <span class="n">EDMapSuffix</span><span class="p">)</span>
  903         
  904         <span class="n">EDMapFileExists</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">EDMapFile</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  905         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">EDMapFile</span><span class="p">):</span>
  906             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^DifferenceMap$&quot;</span><span class="p">,</span> <span class="n">EDMapType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  907                 <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DifferenceMapAvailable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  908                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The ED map file, </span><span class="si">%s</span><span class="s2">, corresponding to EDMapType, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffix</span><span class="se">\&quot;</span><span class="s2"> doesn&#39;t exist. PyMOL groups and objectes related to difference maps won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">EDMapFile</span><span class="p">,</span> <span class="n">EDMapType</span><span class="p">))</span>
  909             <span class="k">else</span><span class="p">:</span>
  910                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The ED map file, </span><span class="si">%s</span><span class="s2">, corresponding to EDMapType, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffix</span><span class="se">\&quot;</span><span class="s2"> doesn&#39;t exist.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">EDMapFile</span><span class="p">,</span> <span class="n">EDMapType</span><span class="p">))</span>
  911             
  912         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapFiles&quot;</span><span class="p">][</span><span class="n">EDMapType</span><span class="p">]</span> <span class="o">=</span> <span class="n">EDMapFile</span>
  913 
  914 <span class="k">def</span> <span class="nf">ProcessChainAndLigandIDs</span><span class="p">():</span>
  915     <span class="sd">&quot;&quot;&quot;Process chain and ligand IDs&quot;&quot;&quot;</span>
  916 
  917     <span class="n">MolName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileRoot&quot;</span><span class="p">]</span>
  918     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">],</span> <span class="n">MolName</span><span class="p">)</span>
  919     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span>
  920     
  921     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="s2">&quot;-c, --chainIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">],</span> <span class="s2">&quot;-l, --ligandIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">])</span>
  922     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span>
  923     
  924     <span class="n">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
  925     
  926     <span class="n">ProcessChainMeshesAndSurfacesOptions</span><span class="p">()</span>
  927 
  928 <span class="k">def</span> <span class="nf">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
  929     <span class="sd">&quot;&quot;&quot;Check presence of valid ligand IDs.&quot;&quot;&quot;</span>
  930 
  931     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specified chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])))</span>
  932     
  933     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  934         <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
  935             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])))</span>
  936         <span class="k">else</span><span class="p">:</span>
  937             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  938             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs found for chain ID, </span><span class="si">%s</span><span class="s2">. PyMOL groups and objects related to ligand and binding pockect won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  939 
  940 <span class="k">def</span> <span class="nf">ProcessChainMeshesAndSurfacesOptions</span><span class="p">():</span>
  941     <span class="sd">&quot;&quot;&quot;Process options to create meshes and surfaces for chains.&quot;&quot;&quot;</span>
  942 
  943     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  944     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  945     
  946     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;EnableChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  947     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;EnableChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  948     
  949     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  950         <span class="n">LigandsPresent</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span> <span class="k">else</span> <span class="bp">False</span>
  951 
  952         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  953             <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">LigandsPresent</span> <span class="k">else</span> <span class="bp">True</span>
  954         <span class="k">else</span><span class="p">:</span>
  955             <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  956         
  957         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  958             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  959                 <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="bp">False</span>
  960             <span class="k">else</span><span class="p">:</span>
  961                 <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="p">(</span><span class="n">LigandsPresent</span> <span class="ow">or</span> <span class="n">MeshChainComplex</span><span class="p">)</span> <span class="k">else</span> <span class="bp">True</span>
  962         <span class="k">else</span><span class="p">:</span>
  963             <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  964         
  965         <span class="k">if</span> <span class="n">LigandsPresent</span><span class="p">:</span>
  966             <span class="n">EnableChainComplexGroup</span> <span class="o">=</span> <span class="bp">False</span>
  967             <span class="n">EnableChainAloneGroup</span> <span class="o">=</span> <span class="bp">True</span>
  968         <span class="k">else</span><span class="p">:</span>
  969             <span class="n">EnableChainComplexGroup</span> <span class="o">=</span> <span class="bp">True</span>
  970             <span class="n">EnableChainAloneGroup</span> <span class="o">=</span> <span class="bp">False</span>
  971 
  972         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">MeshChainComplex</span>
  973         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainComplex</span>
  974         
  975         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;EnableChainComplexGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnableChainComplexGroup</span>
  976         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;EnableChainAloneGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnableChainAloneGroup</span>
  977 
  978 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
  979     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
  980     
  981     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
  982     
  983     <span class="c1"># Validate options...</span>
  984     <span class="n">ValidateOptions</span><span class="p">()</span>
  985     
  986     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  987     
  988     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorChainCartoonPutty&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--BFactorChainCartoonPutty&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  989     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorColorPalette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--BFactorColorPalette&quot;</span><span class="p">]</span>
  990     
  991     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">]</span>
  992     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  993     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileRoot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FileName</span>
  994 
  995     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
  996     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  997     
  998     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
  999     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 1000     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
 1001     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pml$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1002         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1003         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pml$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pme&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1004     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pse$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1005         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> 
 1006         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1007         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pse$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pml&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1008         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]):</span>
 1009             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The intermediate output file to be generated, </span><span class="si">%s</span><span class="s2">, already exist. Use option </span><span class="se">\&quot;</span><span class="s2">--ov</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--overwrite</span><span class="se">\&quot;</span><span class="s2"> and try again.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="p">)</span>
 1010 
 1011     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--EDMapSuffixes&quot;</span><span class="p">]</span>
 1012     <span class="n">ProcessEDMapSuffixes</span><span class="p">()</span>
 1013     
 1014     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">])</span>
 1015     
 1016     <span class="c1"># Process mesh parameters...</span>
 1017     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshCarveRadius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshCarveRadius&quot;</span><span class="p">])</span>
 1018     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1019     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshChainComplex&quot;</span><span class="p">]</span>
 1020     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshWidth&quot;</span><span class="p">])</span>
 1021     
 1022     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshColorCompositeMap&quot;</span><span class="p">]</span>
 1023     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshLevelCompositeMap&quot;</span><span class="p">])</span>
 1024     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh1ColorDiffMap&quot;</span><span class="p">]</span>
 1025     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh1LevelDiffMap&quot;</span><span class="p">])</span>
 1026     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh2ColorDiffMap&quot;</span><span class="p">]</span>
 1027     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh2LevelDiffMap&quot;</span><span class="p">])</span>
 1028     
 1029     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1030     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">]</span>
 1031     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">])</span>
 1032     
 1033     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandColor&quot;</span><span class="p">]</span>
 1034     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsSolventColor&quot;</span><span class="p">]</span>
 1035     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsInorganicColor&quot;</span><span class="p">]</span>
 1036     
 1037     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])</span>
 1038     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketLabelColor&quot;</span><span class="p">]</span>
 1039     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1040     
 1041     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]</span>
 1042     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ligandIDs&quot;</span><span class="p">]</span>
 1043     <span class="n">ProcessChainAndLigandIDs</span><span class="p">()</span>
 1044 
 1045 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span> 
 1046     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 1047     
 1048     <span class="c1"># Get options...</span>
 1049     <span class="k">global</span> <span class="n">Options</span>
 1050     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1051     
 1052     <span class="c1"># Set current working directory to the specified directory...</span>
 1053     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1054     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1055         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1056     
 1057     <span class="c1"># Handle examples option...</span>
 1058     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1059         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1060         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1061 
 1062 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1063     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 1064     
 1065     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1066     
 1067     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--BFactorChainCartoonPutty&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--BFactorChainCartoonPutty&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1068     
 1069     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">])</span>
 1070     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1071     
 1072     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;pml pse&quot;</span><span class="p">)</span>
 1073     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1074     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1075     
 1076     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1077     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1078 
 1079     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--meshCarveRadius&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshCarveRadius&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1080     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--meshComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1081     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--meshChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1082     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--meshWidth&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshWidth&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1083     
 1084     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--meshLevelCompositeMap&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1085     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--mesh1LevelDiffMap&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1086     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--mesh2LevelDiffMap&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1087     
 1088     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1089     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1090     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
 1091     
 1092     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1093     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1094     
 1095 <span class="c1"># Setup a usage string for docopt...</span>
 1096 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 1097 <span class="s2">PyMOLVisualizeElectronDensity.py - Visualize electron density</span>
 1098 
 1099 <span class="s2">Usage:</span>
 1100 <span class="s2">    PyMOLVisualizeElectronDensity.py [--allowEmptyObjects &lt;yes or no&gt;]</span>
 1101 <span class="s2">                                     [--BFactorChainCartoonPutty &lt;yes or no&gt;] [--BFactorColorPalette &lt;text&gt; ]</span>
 1102 <span class="s2">                                     [--chainIDs &lt;First, All or ID1,ID2...&gt;] [--EDMapSuffixes &lt;CompositeMap,None,...&gt;]</span>
 1103 <span class="s2">                                     [--ligandIDs &lt;Largest, All or ID1,ID2...&gt;] [--labelFontID &lt;number&gt;]</span>
 1104 <span class="s2">                                     [--meshCarveRadius &lt;number&gt;] [--meshComplex &lt;yes or no&gt;]</span>
 1105 <span class="s2">                                     [--meshChainComplex &lt;yes or no&gt;] [--meshColorCompositeMap &lt;text&gt;]</span>
 1106 <span class="s2">                                     [--meshLevelCompositeMap &lt;number&gt;] [--meshWidth &lt;number&gt;]</span>
 1107 <span class="s2">                                     [--mesh1ColorDiffMap &lt;text&gt;] [--mesh1LevelDiffMap &lt;number&gt;]</span>
 1108 <span class="s2">                                     [--mesh2ColorDiffMap &lt;text&gt;] [--mesh2LevelDiffMap &lt;number&gt;]</span>
 1109 <span class="s2">                                     [--PMLOut &lt;yes or no&gt;] [--pocketContactsLigandColor &lt;text&gt;]</span>
 1110 <span class="s2">                                     [--pocketContactsSolventColor &lt;text&gt;] [--pocketContactsInorganicColor &lt;text&gt;]</span>
 1111 <span class="s2">                                     [--pocketDistanceCutoff &lt;number&gt;] [--pocketLabelColor &lt;text&gt;]</span>
 1112 <span class="s2">                                     [--pocketSurface &lt;yes or no&gt;] [--surfaceComplex &lt;yes or no&gt; ] [--surfaceChainComplex &lt;yes or no&gt;]</span>
 1113 <span class="s2">                                     [--surfaceTransparency &lt;number&gt;] [--overwrite] [-w &lt;dir&gt;] -i &lt;infile&gt; -o &lt;outfile&gt;</span>
 1114 <span class="s2">    PyMOLVisualizeElectronDensity.py -h | --help | -e | --examples</span>
 1115 
 1116 <span class="s2">Description:</span>
 1117 <span class="s2">    Generate PyMOL visualization files for viewing X-ray electron density around</span>
 1118 <span class="s2">    chains, ligands, and ligand binding pockets in macromolecules including proteins</span>
 1119 <span class="s2">    and nucleic acids.</span>
 1120 
 1121 <span class="s2">    The supported input file formats are: Macromolecule - PDB (.pdb) or CIF(.cif),</span>
 1122 <span class="s2">    Electron Density - Collaborative Computational Project Number 4 (CCP4) ( .ccp4)</span>
 1123 
 1124 <span class="s2">    The supported output file formats are: PyMOL script file (.pml), PyMOL session</span>
 1125 <span class="s2">    file (.pse)</span>
 1126 
 1127 <span class="s2">    Two types of CCP4 electron density map files may be used for visualizing electron</span>
 1128 <span class="s2">    density. These file types along with default file names are shown below:</span>
 1129 <span class="s2">    </span>
 1130 <span class="s2">        CompositeMap (2Fobs - Fcalc) - &lt;InfileRoot&gt;.ccp4 (required)</span>
 1131 <span class="s2">        DifferenceMap (Fobs - Fcalc) - &lt;InfileRoot&gt;_diff.ccp4 (optional)</span>
 1132 <span class="s2">    </span>
 1133 <span class="s2">    The compsite map file must be present. The difference map file is optional.</span>
 1134 <span class="s2">    The mesh and surface PyMOL objects are not generated for missing difference</span>
 1135 <span class="s2">    map file.</span>
 1136 
 1137 <span class="s2">    The electron density present in composite map file is generated by adding two</span>
 1138 <span class="s2">    difference maps to a calculated map (Fcalc) as shown below:</span>
 1139 <span class="s2">    </span>
 1140 <span class="s2">        Fcalc + 2(Fobs - Fcalc) = 2Fobs - Fcalc</span>
 1141 <span class="s2">    </span>
 1142 <span class="s2">    The following types of meshes may be created by default for electron density</span>
 1143 <span class="s2">    present in composite and difference map files:</span>
 1144 <span class="s2">    </span>
 1145 <span class="s2">        CompositeMesh - ContourLevel: 1; Color: Blue</span>
 1146 <span class="s2">        DiffMesh1 - ContourLevel: 3; Color: Green</span>
 1147 <span class="s2">        DiffMesh2 - ContourLevel: -3; Color: Red</span>
 1148 
 1149 <span class="s2">    The two meshes created for difference maps correspond to false negative and</span>
 1150 <span class="s2">    false positive in terms of electron density present in the model. The first mesh</span>
 1151 <span class="s2">    shown in  green color corresponds to observed electron density missing in the</span>
 1152 <span class="s2">    model. The second mesh in in red color indicates model electron density not</span>
 1153 <span class="s2">    observed in the experiment.</span>
 1154 <span class="s2">    </span>
 1155 <span class="s2">    A variety of PyMOL groups and objects may be  created for visualization of</span>
 1156 <span class="s2">    electron density present in map files. These groups and objects correspond to</span>
 1157 <span class="s2">    maps, meshes, surfaces,chains, ligands, inorganics, ligand binding pockets,</span>
 1158 <span class="s2">    pocket, polar interactions, and pocket hydrophobic surfaces. A complete</span>
 1159 <span class="s2">    hierarchy of all possible PyMOL groups and objects is shown below:</span>
 1160 <span class="s2">    </span>
 1161 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1162 <span class="s2">            .Complex</span>
 1163 <span class="s2">                .Complex</span>
 1164 <span class="s2">                .2Fo-Fc</span>
 1165 <span class="s2">                    .Map</span>
 1166 <span class="s2">                    .Mesh</span>
 1167 <span class="s2">                    .Surface</span>
 1168 <span class="s2">                .Fo-Fc</span>
 1169 <span class="s2">                    .Map</span>
 1170 <span class="s2">                    .Mesh1</span>
 1171 <span class="s2">                    .Surface1</span>
 1172 <span class="s2">                    .Mesh2</span>
 1173 <span class="s2">                    .Surface2</span>
 1174 <span class="s2">            .Chain&lt;ID&gt;</span>
 1175 <span class="s2">                .Complex</span>
 1176 <span class="s2">                    .Complex</span>
 1177 <span class="s2">                    .2Fo-Fc</span>
 1178 <span class="s2">                        .Mesh</span>
 1179 <span class="s2">                        .Surface</span>
 1180 <span class="s2">                    .Fo-Fc</span>
 1181 <span class="s2">                        .Mesh1</span>
 1182 <span class="s2">                        .Surface1</span>
 1183 <span class="s2">                        .Mesh2</span>
 1184 <span class="s2">                        .Surface2</span>
 1185 <span class="s2">                .Chain</span>
 1186 <span class="s2">                    .Chain</span>
 1187 <span class="s2">                    .BFactor</span>
 1188 <span class="s2">                .Solvent</span>
 1189 <span class="s2">                .Inorganic</span>
 1190 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1191 <span class="s2">                    .Ligand</span>
 1192 <span class="s2">                        .Ligand</span>
 1193 <span class="s2">                        .2Fo-Fc</span>
 1194 <span class="s2">                            .Mesh</span>
 1195 <span class="s2">                            .Surface</span>
 1196 <span class="s2">                        .Fo-Fc</span>
 1197 <span class="s2">                            .Mesh1</span>
 1198 <span class="s2">                            .Surface1</span>
 1199 <span class="s2">                            .Mesh2</span>
 1200 <span class="s2">                            .Surface2</span>
 1201 <span class="s2">                    .Pocket</span>
 1202 <span class="s2">                        .Pocket</span>
 1203 <span class="s2">                        .2Fo-Fc</span>
 1204 <span class="s2">                            .Mesh</span>
 1205 <span class="s2">                            .Surface</span>
 1206 <span class="s2">                        .Fo-Fc</span>
 1207 <span class="s2">                            .Mesh1</span>
 1208 <span class="s2">                            .Surface1</span>
 1209 <span class="s2">                            .Mesh2</span>
 1210 <span class="s2">                            .Surface2</span>
 1211 <span class="s2">                        .Polar_Contacts</span>
 1212 <span class="s2">                        .Surface</span>
 1213 <span class="s2">                    .Pocket_Solvent</span>
 1214 <span class="s2">                        .Pocket_Solvent</span>
 1215 <span class="s2">                        .2Fo-Fc</span>
 1216 <span class="s2">                            .Mesh</span>
 1217 <span class="s2">                            .Surface</span>
 1218 <span class="s2">                        .Fo-Fc</span>
 1219 <span class="s2">                            .Mesh1</span>
 1220 <span class="s2">                            .Surface1</span>
 1221 <span class="s2">                            .Mesh2</span>
 1222 <span class="s2">                            .Surface2</span>
 1223 <span class="s2">                        .Polar_Contacts</span>
 1224 <span class="s2">                    .Pocket_Inorganic</span>
 1225 <span class="s2">                        .Pocket_Inorganic</span>
 1226 <span class="s2">                        .2Fo-Fc</span>
 1227 <span class="s2">                            .Mesh</span>
 1228 <span class="s2">                            .Surface</span>
 1229 <span class="s2">                        .Fo-Fc</span>
 1230 <span class="s2">                            .Mesh1</span>
 1231 <span class="s2">                            .Surface1</span>
 1232 <span class="s2">                            .Mesh2</span>
 1233 <span class="s2">                            .Surface2</span>
 1234 <span class="s2">                        .Polar_Contacts</span>
 1235 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1236 <span class="s2">                    .Ligand</span>
 1237 <span class="s2">                        ... ... ...</span>
 1238 <span class="s2">                    .Pocket</span>
 1239 <span class="s2">                        ... ... ...</span>
 1240 <span class="s2">                    .Pocket_Solvent</span>
 1241 <span class="s2">                        ... ... ...</span>
 1242 <span class="s2">                    .Pocket_Inorganic</span>
 1243 <span class="s2">                        ... ... ...</span>
 1244 <span class="s2">            .Chain&lt;ID&gt;</span>
 1245 <span class="s2">                ... ... ...</span>
 1246 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1247 <span class="s2">                    ... ... ...</span>
 1248 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1249 <span class="s2">                    ... ... ...</span>
 1250 <span class="s2">            .Chain&lt;ID&gt;</span>
 1251 <span class="s2">                ... ... ...</span>
 1252 <span class="s2">    </span>
 1253 <span class="s2">    The meshes and surfaces  are not created for complete complex in input file</span>
 1254 <span class="s2">    by default. A word to the wise: The creation of these surface and mesh objects</span>
 1255 <span class="s2">    may slow down loading of PML file and generation of PSE file, based on the size</span>
 1256 <span class="s2">    of input complex and map files. The generation of PSE file may also fail.</span>
 1257 
 1258 <span class="s2">Options:</span>
 1259 <span class="s2">    -a, --allowEmptyObjects &lt;yes or no&gt;  [default: no]</span>
 1260 <span class="s2">        Allow creation of empty PyMOL objects corresponding to solvent and</span>
 1261 <span class="s2">        inorganic atom selections across chains, ligands, and ligand binding pockets</span>
 1262 <span class="s2">        in input file.</span>
 1263 <span class="s2">    -c, --chainIDs &lt;First, All or ID1,ID2...&gt;  [default: First]</span>
 1264 <span class="s2">        List of chain IDs to use for visualizing electron density. Possible values:</span>
 1265 <span class="s2">        First, All, or a comma delimited list of chain IDs. The default is to use the</span>
 1266 <span class="s2">        chain ID for the first chain in input file.</span>
 1267 <span class="s2">    -b, --BFactorChainCartoonPutty &lt;yes or no&gt;  [default: yes]</span>
 1268 <span class="s2">        A cartoon putty around individual chains colored by B factors. The minimum</span>
 1269 <span class="s2">        and maximum values for B factors are automatically detected. These values</span>
 1270 <span class="s2">        indicate spread of electron density around atoms. The &#39;blue_white_red&#39; color</span>
 1271 <span class="s2">        palette is deployed for coloring the cartoon putty.</span>
 1272 <span class="s2">    --BFactorColorPalette &lt;text&gt;  [default: blue_white_red]</span>
 1273 <span class="s2">        Color palette for coloring cartoon putty around chains generated using B</span>
 1274 <span class="s2">        factors. An valid PyMOL color palette name is allowed. No validation is</span>
 1275 <span class="s2">        performed. The complete list of valid color palette names is a available</span>
 1276 <span class="s2">        at: pymolwiki.org/index.php/Spectrum. Examples: blue_white_red,</span>
 1277 <span class="s2">        blue_white_magenta, blue_red, green_white_red, green_red.</span>
 1278 <span class="s2">    -e, --examples</span>
 1279 <span class="s2">        Print examples.</span>
 1280 <span class="s2">    --EDMapSuffixes &lt;CompositeMap,None,...&gt;  [default: auto]</span>
 1281 <span class="s2">        Electron density map file suffixes for generating names of map files from</span>
 1282 <span class="s2">        the root of input file. It is a pairwise comma delimited list of &#39;EDMapType&#39;</span>
 1283 <span class="s2">        and file suffix.</span>
 1284 <span class="s2">        </span>
 1285 <span class="s2">        Supported values for &#39;EDMapType&#39;: &#39;CompositeMap, DifferenceMap&#39;.</span>
 1286 <span class="s2">        Supported value for file suffix: Any valid string.</span>
 1287 <span class="s2">        </span>
 1288 <span class="s2">        Default value: &#39;CompositeMap,None,DifferenceMap,_diff&#39;</span>
 1289 <span class="s2">        </span>
 1290 <span class="s2">        The default names of the map files, generated form a combination of</span>
 1291 <span class="s2">        &#39;InfileRoot&#39; and &#39;EDSMapType&#39; are shown below:</span>
 1292 <span class="s2">            </span>
 1293 <span class="s2">            CompositeMap (2Fobs - Fcalc) - &lt;InfileRoot&gt;.ccp4</span>
 1294 <span class="s2">            DifferenceMap (Fobs - Fcalc) - &lt;InfileRoot&gt;_diff.ccp4</span>
 1295 <span class="s2">            </span>
 1296 <span class="s2">        The composite map file must be present. The difference map file is</span>
 1297 <span class="s2">        optional.</span>
 1298 <span class="s2">    -h, --help</span>
 1299 <span class="s2">        Print this help message.</span>
 1300 <span class="s2">    -i, --infile &lt;infile&gt;</span>
 1301 <span class="s2">        Input file name.</span>
 1302 <span class="s2">    -l, --ligandIDs &lt;Largest, All or ID1,ID2...&gt;  [default: Largest]</span>
 1303 <span class="s2">        List of ligand IDs present in chains for visualizing electron density across</span>
 1304 <span class="s2">        ligands and ligand binding pockets. Possible values: Largest, All, or a comma</span>
 1305 <span class="s2">        delimited list of ligand IDs. The default is to use the largest ligand present</span>
 1306 <span class="s2">        in all or specified chains in input file.</span>
 1307 <span class="s2">        </span>
 1308 <span class="s2">        Ligands are identified using organic selection operator available in PyMOL.</span>
 1309 <span class="s2">        It&#39;ll also  identify buffer molecules as ligands. The largest ligand contains</span>
 1310 <span class="s2">        the highest number of heavy atoms.</span>
 1311 <span class="s2">    --labelFontID &lt;number&gt;  [default: 7]</span>
 1312 <span class="s2">        Font ID for drawing labels. Default: 7 (Sans Bold). Valid values: 5 to 16.</span>
 1313 <span class="s2">        The specified value must be a valid PyMOL font ID. No validation is</span>
 1314 <span class="s2">        performed. The complete lists of valid font IDs is available at:</span>
 1315 <span class="s2">        pymolwiki.org/index.php/Label_font_id. Examples: 5 - Sans;</span>
 1316 <span class="s2">        7 - Sans Bold; 9 - Serif; 10 - Serif Bold.</span>
 1317 <span class="s2">    --meshCarveRadius &lt;number&gt;  [default: 1.6]</span>
 1318 <span class="s2">        Radius in Angstroms around atoms for including electron density.</span>
 1319 <span class="s2">    --meshComplex &lt;yes or no&gt;  [default: no]</span>
 1320 <span class="s2">        Create meshes for complete complex in input file corresponding to composite</span>
 1321 <span class="s2">        and difference maps. A total of three meshes, one for composite map and</span>
 1322 <span class="s2">        two for difference map, are created for the complete complex.</span>
 1323 <span class="s2">        </span>
 1324 <span class="s2">        The composite and difference maps are always loaded for the complex.</span>
 1325 <span class="s2">    --meshChainComplex &lt;yes, no, or auto&gt;  [default: auto]</span>
 1326 <span class="s2">        Create meshes for individual chain complex in input file corresponding to</span>
 1327 <span class="s2">        composite and difference maps. A total of three meshes, one for composite map</span>
 1328 <span class="s2">        map and two for difference map, are created for each chain complex. By default,</span>
 1329 <span class="s2">        the meshes are automatically created for chain complexes without any ligands. </span>
 1330 <span class="s2">    --meshColorCompositeMap &lt;text&gt;  [default: blue]</span>
 1331 <span class="s2">        Line color for mesh corresponding to composite map. The specified value</span>
 1332 <span class="s2">        must be valid color. No validation is performed.</span>
 1333 <span class="s2">    --meshLevelCompositeMap &lt;number&gt;  [default: 1.0]</span>
 1334 <span class="s2">        Contour level in sigma units for generating mesh corresponding to composite</span>
 1335 <span class="s2">        map.</span>
 1336 <span class="s2">    --meshWidth &lt;number&gt;  [default: 0.5]</span>
 1337 <span class="s2">        Line width for mesh lines corresponding to composite and difference maps.</span>
 1338 <span class="s2">    --mesh1ColorDiffMap &lt;text&gt;  [default: green]</span>
 1339 <span class="s2">        Line color for first mesh corresponding to difference map at contour level</span>
 1340 <span class="s2">        specified by &#39;--mesh1LevelDiffMap&#39;. The specified value must be valid color.</span>
 1341 <span class="s2">        No validation is performed.</span>
 1342 <span class="s2">    --mesh1LevelDiffMap &lt;number&gt;  [default: 3.0]</span>
 1343 <span class="s2">        Contour level in sigma units for generating first mesh corresponding to </span>
 1344 <span class="s2">        to  difference map.</span>
 1345 <span class="s2">    --mesh2ColorDiffMap &lt;text&gt;  [default: red]</span>
 1346 <span class="s2">        Line color for second mesh corresponding to difference map at contour level</span>
 1347 <span class="s2">        specified by &#39;--mesh2LevelDiffMap&#39;. The specified value must be valid color.</span>
 1348 <span class="s2">        No validation is performed.</span>
 1349 <span class="s2">    --mesh2LevelDiffMap &lt;number&gt;  [default: -3.0]</span>
 1350 <span class="s2">        Contour level in sigma units for generating second mesh corresponding to</span>
 1351 <span class="s2">        difference map.</span>
 1352 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 1353 <span class="s2">        Output file name.</span>
 1354 <span class="s2">    -p, --PMLOut &lt;yes or no&gt;  [default: yes]</span>
 1355 <span class="s2">        Save PML file during generation of PSE file.</span>
 1356 <span class="s2">    --pocketContactsLigandColor &lt;text&gt;  [default: orange]</span>
 1357 <span class="s2">        Color for drawing polar contacts between ligand and pocket residues.</span>
 1358 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1359 <span class="s2">    --pocketContactsSolventColor &lt;text&gt;  [default: marine]</span>
 1360 <span class="s2">        Color for drawing polar contacts between solvent and pocket residues..</span>
 1361 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1362 <span class="s2">    --pocketContactsInorganicColor &lt;text&gt;  [default: deepsalmon]</span>
 1363 <span class="s2">        Color for drawing polar contacts between inorganic and pocket residues.</span>
 1364 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1365 <span class="s2">    --pocketDistanceCutoff &lt;number&gt;  [default: 5.0]</span>
 1366 <span class="s2">        Distance in Angstroms for identifying pocket residues around ligands.</span>
 1367 <span class="s2">    --pocketLabelColor &lt;text&gt;  [default: magenta]</span>
 1368 <span class="s2">        Color for drawing residue or atom level labels for a pocket. The specified</span>
 1369 <span class="s2">        value must be valid color. No validation is performed.</span>
 1370 <span class="s2">    --pocketSurface &lt;yes or no&gt;  [default: yes]</span>
 1371 <span class="s2">        Hydrophobic surface around pocket. The pocket surface is colored by</span>
 1372 <span class="s2">        hydrophobicity. It is only valid for proteins. The color of amino acids is</span>
 1373 <span class="s2">        set using the Eisenberg hydrophobicity scale. The color varies from red</span>
 1374 <span class="s2">        to white, red being the most hydrophobic amino acid.</span>
 1375 <span class="s2">    --surfaceComplex &lt;yes or no&gt;  [default: no]</span>
 1376 <span class="s2">        Create surfaces for complete complex in input file corresponding to composite</span>
 1377 <span class="s2">        and difference maps. A total of three surfaces, one for composite map and</span>
 1378 <span class="s2">        two for difference map, are created for the complete complex.</span>
 1379 <span class="s2">        </span>
 1380 <span class="s2">        The composite and difference maps are always loaded for the complex.</span>
 1381 <span class="s2">    --surfaceChainComplex &lt;yes, no or auto&gt;  [default: auto]</span>
 1382 <span class="s2">        Create surfaces for individual chain complexes in input file corresponding to</span>
 1383 <span class="s2">        composite and difference maps. A total of three surfaces, one for composite</span>
 1384 <span class="s2">        map and two for difference map, are created for each chain complex. By default,</span>
 1385 <span class="s2">        the surfaces are automatically created for chain complexes without any ligands. </span>
 1386 <span class="s2">    --surfaceTransparency &lt;number&gt;  [default: 0.25]</span>
 1387 <span class="s2">        Surface transparency for molecular and electron density surfaces.</span>
 1388 <span class="s2">    --overwrite</span>
 1389 <span class="s2">        Overwrite existing files.</span>
 1390 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 1391 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 1392 
 1393 <span class="s2">Examples:</span>
 1394 <span class="s2">    To visualize electron density for the largest ligand in the first chain, and</span>
 1395 <span class="s2">    ligand binding pockets to highlight ligand interactions with pockect residues,</span>
 1396 <span class="s2">    solvents and inorganics, in a PDB and using corresponding map files, and</span>
 1397 <span class="s2">    generate a PML file, type:</span>
 1398 
 1399 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 1400 
 1401 <span class="s2">    To visualize electron density for all ligands in all chains, and ligand binding</span>
 1402 <span class="s2">    pockets to highlight ligand interactions with pockect residues, solvents</span>
 1403 <span class="s2">    and inorganics, in a PDB and using corresponding map files, and generate</span>
 1404 <span class="s2">    a PML file, type:</span>
 1405 
 1406 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 1407 <span class="s2">          -c All -l All</span>
 1408 
 1409 <span class="s2">    To visualize electron density for all chains and ligands, along with displaying</span>
 1410 <span class="s2">    meshes and surfaces for complete complex and individual chains, in a PDB</span>
 1411 <span class="s2">    file and using  corresponding map files, and generate a PML file, type:</span>
 1412 
 1413 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 1414 <span class="s2">          --chainIDs All --ligandIDs All --meshComplex yes --surfaceComplex yes</span>
 1415 <span class="s2">          --meshChainComplex yes --surfaceChainComplex yes</span>
 1416 
 1417 <span class="s2">    To visualize electron density for ligand ADP in chain E along with ligand binding</span>
 1418 <span class="s2">    pocket, in a PDB and using  corresponding map files, and generate a PSE file, type:</span>
 1419 
 1420 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pse</span>
 1421 <span class="s2">          --chainIDs E --ligandIDs ADP</span>
 1422 
 1423 <span class="s2">    To visualize electron density for all igands in all chains along with their binding</span>
 1424 <span class="s2">    pockets in a PDB file and using explicit file name suffixes for map files, and</span>
 1425 <span class="s2">    generate a PML file, type:</span>
 1426 
 1427 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 1428 <span class="s2">          --chainIDs All --ligandIDs All --EDMapSuffixes &quot;CompositeMap,None,</span>
 1429 <span class="s2">          DifferenceMap,_diff&quot;</span>
 1430 
 1431 <span class="s2">Author:</span>
 1432 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 1433 
 1434 <span class="s2">See also:</span>
 1435 <span class="s2">    DownloadPDBFiles.pl, PyMOLVisualizeCryoEMDensity.py,</span>
 1436 <span class="s2">    PyMOLVisualizeMacromolecules.py</span>
 1437 
 1438 <span class="s2">Copyright:</span>
 1439 <span class="s2">    Copyright (C) 2018 Manish Sud. All rights reserved.</span>
 1440 
 1441 <span class="s2">    The functionality available in this script is implemented using PyMOL, a</span>
 1442 <span class="s2">    molecular visualization system on an open source foundation originally</span>
 1443 <span class="s2">    developed by Warren DeLano.</span>
 1444 
 1445 <span class="s2">    This file is part of MayaChemTools.</span>
 1446 
 1447 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 1448 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 1449 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 1450 <span class="s2">    later version.</span>
 1451 
 1452 <span class="s2">&quot;&quot;&quot;</span>
 1453 
 1454 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 1455     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
